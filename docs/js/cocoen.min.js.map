{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/js/cocoen.js"],"names":[],"mappings":"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","file":"cocoen.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","const init = Symbol('init');\nconst createElements = Symbol('createElements');\nconst addEventListeners = Symbol('addEventListeners');\n\nclass Cocoen {\n  constructor(element, options) {\n    this.options = Object.assign({}, Cocoen.defaults, options);\n    this.element = element || document.querySelector('.cocoen');\n\n    this[init]();\n  }\n\n  [init]() {\n    this[createElements]();\n    this[addEventListeners]();\n    this.dimensions();\n  }\n\n  [createElements]() {\n    // Create drag element\n    const span = document.createElement('span');\n    span.className = this.options.dragElementSelector.replace('.', '');\n    this.element.appendChild(span);\n    // Wrap first image in div\n    const wrapper = document.createElement('div');\n    const firstImage = this.element.querySelector('img:first-child');\n    firstImage.before(wrapper);\n    wrapper.append(firstImage);\n    // Set class elements we need later\n    this.dragElement = this.element.querySelector(this.options.dragElementSelector);\n    this.beforeElement = this.element.querySelector('div:first-child');\n    this.beforeImage = this.beforeElement.querySelector('img');\n  }\n\n  [addEventListeners]() {\n    this.element.addEventListener('click', this.onTap.bind(this));\n    this.element.addEventListener('mousemove', this.onDrag.bind(this));\n    this.element.addEventListener('touchmove', this.onDrag.bind(this));\n    this.dragElement.addEventListener('mousedown', this.onDragStart.bind(this));\n    this.dragElement.addEventListener('touchstart', this.onDragStart.bind(this));\n\n    window.addEventListener('mouseup', this.onDragEnd.bind(this));\n    window.addEventListener('resize', this.dimensions.bind(this));\n  }\n\n  onTap(e) {\n    e.preventDefault();\n\n    this.leftPos = (e.pageX) ? e.pageX : e.originalEvent.touches[0].pageX;\n    this.requestDrag();\n  }\n\n  onDragStart(e) {\n    e.preventDefault();\n\n    const startX = (e.pageX) ? e.pageX : e.originalEvent.touches[0].pageX;\n    const offsetLeft = this.dragElement.getBoundingClientRect().left + document.body.scrollLeft;\n    this.posX = (offsetLeft + this.dragElementWidth) - startX;\n    this.isDragging = true;\n  }\n\n  onDragEnd(e) {\n    e.preventDefault();\n    this.isDragging = false;\n  }\n\n  onDrag(e) {\n    e.preventDefault();\n\n    if (!this.isDragging) {\n      return;\n    }\n\n    this.moveX = (e.pageX) ? e.pageX : e.originalEvent.touches[0].pageX;\n    this.leftPos = (this.moveX + this.posX) - this.dragElementWidth;\n\n    this.requestDrag();\n  }\n\n  dimensions() {\n    this.elementWidth = parseInt(window.getComputedStyle(this.element).width, 10);\n    this.elementOffsetLeft = this.element.getBoundingClientRect().left + document.body.scrollLeft;\n    this.beforeImage.style.width = `${this.elementWidth}px`;\n    this.dragElementWidth = parseInt(window.getComputedStyle(this.dragElement).width, 10);\n    this.minLeftPos = this.elementOffsetLeft + 10;\n    this.maxLeftPos = (this.elementOffsetLeft + this.elementWidth) - this.dragElementWidth - 10;\n  }\n\n  drag() {\n    if (this.leftPos < this.minLeftPos) {\n      this.leftPos = this.minLeftPos;\n    } else if (this.leftPos > this.maxLeftPos) {\n      this.leftPos = this.maxLeftPos;\n    }\n\n    let openRatio = (this.leftPos + (this.dragElementWidth / 2)) - this.elementOffsetLeft;\n    openRatio /= this.elementWidth;\n    const width = `${openRatio * 100}%`;\n\n    this.dragElement.style.left = width;\n    this.beforeElement.style.width = width;\n\n    if (this.options.dragCallback) {\n      this.options.dragCallback(openRatio);\n    }\n  }\n\n  requestDrag() {\n    window.requestAnimationFrame(this.drag.bind(this));\n  }\n}\n\nCocoen.defaults = {\n  dragElementSelector: '.cocoen-drag',\n  dragCallback: null,\n};\n\nmodule.exports = Cocoen;\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvY29jb2VuLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7O0FDQUEsSUFBTSxPQUFPLE9BQU8sTUFBUCxDQUFiO0FBQ0EsSUFBTSxpQkFBaUIsT0FBTyxnQkFBUCxDQUF2QjtBQUNBLElBQU0sb0JBQW9CLE9BQU8sbUJBQVAsQ0FBMUI7O0lBRU0sTTtBQUNKLGtCQUFZLE9BQVosRUFBcUIsT0FBckIsRUFBOEI7QUFBQTs7QUFDNUIsU0FBSyxPQUFMLEdBQWUsT0FBTyxNQUFQLENBQWMsRUFBZCxFQUFrQixPQUFPLFFBQXpCLEVBQW1DLE9BQW5DLENBQWY7QUFDQSxTQUFLLE9BQUwsR0FBZSxXQUFXLFNBQVMsYUFBVCxDQUF1QixTQUF2QixDQUExQjs7QUFFQSxTQUFLLElBQUw7QUFDRDs7O1NBRUEsSTs0QkFBUTtBQUNQLFdBQUssY0FBTDtBQUNBLFdBQUssaUJBQUw7QUFDQSxXQUFLLFVBQUw7QUFDRDs7U0FFQSxjOzRCQUFrQjtBQUNqQjtBQUNBLFVBQU0sT0FBTyxTQUFTLGFBQVQsQ0FBdUIsTUFBdkIsQ0FBYjtBQUNBLFdBQUssU0FBTCxHQUFpQixLQUFLLE9BQUwsQ0FBYSxtQkFBYixDQUFpQyxPQUFqQyxDQUF5QyxHQUF6QyxFQUE4QyxFQUE5QyxDQUFqQjtBQUNBLFdBQUssT0FBTCxDQUFhLFdBQWIsQ0FBeUIsSUFBekI7QUFDQTtBQUNBLFVBQU0sVUFBVSxTQUFTLGFBQVQsQ0FBdUIsS0FBdkIsQ0FBaEI7QUFDQSxVQUFNLGFBQWEsS0FBSyxPQUFMLENBQWEsYUFBYixDQUEyQixpQkFBM0IsQ0FBbkI7QUFDQSxpQkFBVyxNQUFYLENBQWtCLE9BQWxCO0FBQ0EsY0FBUSxNQUFSLENBQWUsVUFBZjtBQUNBO0FBQ0EsV0FBSyxXQUFMLEdBQW1CLEtBQUssT0FBTCxDQUFhLGFBQWIsQ0FBMkIsS0FBSyxPQUFMLENBQWEsbUJBQXhDLENBQW5CO0FB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LGlCQUFMLEdBQXlCLEVBQTNDO0FBQ0EsV0FBSyxVQUFMLEdBQW1CLEtBQUssaUJBQUwsR0FBeUIsS0FBSyxZQUEvQixHQUErQyxLQUFLLGdCQUFwRCxHQUF1RSxFQUF6RjtBQUNEOzs7MkJBRU07QUFDTCxVQUFJLEtBQUssT0FBTCxHQUFlLEtBQUssVUFBeEIsRUFBb0M7QUFDbEMsYUFBSyxPQUFMLEdBQWUsS0FBSyxVQUFwQjtBQUNELE9BRkQsTUFFTyxJQUFJLEtBQUssT0FBTCxHQUFlLEtBQUssVUFBeEIsRUFBb0M7QUFDekMsYUFBSyxPQUFMLEdBQWUsS0FBSyxVQUFwQjtBQUNEOztBQUVELFVBQUksWUFBYSxLQUFLLE9BQUwsR0FBZ0IsS0FBSyxnQkFBTCxHQUF3QixDQUF6QyxHQUErQyxLQUFLLGlCQUFwRTtBQUNBLG1CQUFhLEtBQUssWUFBbEI7QUFDQSxVQUFNLFFBQVcsWUFBWSxHQUF2QixNQUFOOztBQUVBLFdBQUssV0FBTCxDQUFpQixLQUFqQixDQUF1QixJQUF2QixHQUE4QixLQUE5QjtBQUNBLFdBQUssYUFBTCxDQUFtQixLQUFuQixDQUF5QixLQUF6QixHQUFpQyxLQUFqQzs7QUFFQSxVQUFJLEtBQUssT0FBTCxDQUFhLFlBQWpCLEVBQStCO0FBQzdCLGFBQUssT0FBTCxDQUFhLFlBQWIsQ0FBMEIsU0FBMUI7QUFDRDtBQUNGOzs7a0NBRWE7QUFDWixhQUFPLHFCQUFQLENBQTZCLEtBQUssSUFBTCxDQUFVLElBQVYsQ0FBZSxJQUFmLENBQTdCO0FBQ0Q7Ozs7OztBQUdILE9BQU8sUUFBUCxHQUFrQjtBQUNoQix1QkFBcUIsY0FETDtBQUVoQixnQkFBYztBQUZFLENBQWxCOztBQUtBLE9BQU8sT0FBUCxHQUFpQixNQUFqQiIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJjb25zdCBpbml0ID0gU3ltYm9sKCdpbml0Jyk7XG5jb25zdCBjcmVhdGVFbGVtZW50cyA9IFN5bWJvbCgnY3JlYXRlRWxlbWVudHMnKTtcbmNvbnN0IGFkZEV2ZW50TGlzdGVuZXJzID0gU3ltYm9sKCdhZGRFdmVudExpc3RlbmVycycpO1xuXG5jbGFzcyBDb2NvZW4ge1xuICBjb25zdHJ1Y3RvcihlbGVtZW50LCBvcHRpb25zKSB7XG4gICAgdGhpcy5vcHRpb25zID0gT2JqZWN0LmFzc2lnbih7fSwgQ29jb2VuLmRlZmF1bHRzLCBvcHRpb25zKTtcbiAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50IHx8IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb2NvZW4nKTtcblxuICAgIHRoaXNbaW5pdF0oKTtcbiAgfVxuXG4gIFtpbml0XSgpIHtcbiAgICB0aGlzW2NyZWF0ZUVsZW1lbnRzXSgpO1xuICAgIHRoaXNbYWRkRXZlbnRMaXN0ZW5lcnNdKCk7XG4gICAgdGhpcy5kaW1lbnNpb25zKCk7XG4gIH1cblxuICBbY3JlYXRlRWxlbWVudHNdKCkge1xuICAgIC8vIENyZWF0ZSBkcmFnIGVsZW1lbnRcbiAgICBjb25zdCBzcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgIHNwYW4uY2xhc3NOYW1lID0gdGhpcy5vcHRpb25zLmRyYWdFbGVtZW50U2VsZWN0b3IucmVwbGFjZSgnLicsICcnKTtcbiAgICB0aGlzLmVsZW1lbnQuYXBwZW5kQ2hpbGQoc3Bhbik7XG4gICAgLy8gV3JhcCBmaXJzdCBpbWFnZSBpbiBkaXZcbiAgICBjb25zdCB3cmFwcGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgY29uc3QgZmlyc3RJbWFnZSA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCdpbWc6Zmlyc3QtY2hpbGQnKTtcbiAgICBmaXJzdEltYWdlLmJlZm9yZSh3cmFwcGVyKTtcbiAgICB3cmFwcGVyLmFwcGVuZChmaXJzdEltYWdlKTtcbiAgICAvLyBTZXQgY2xhc3MgZWxlbWVudHMgd2UgbmVlZCBsYXRlclxuICAgIHRoaXMuZHJhZ0VsZW1lbnQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLm9wdGlvbnMuZHJhZ0VsZW1lbnRTZWxlY3Rvcik7XG4gICAgdGhpcy5iZWZvcmVFbGVtZW50ID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2RpdjpmaXJzdC1jaGlsZCcpO1xuICAgIHRoaXMuYmVmb3JlSW1hZ2UgPSB0aGlzLmJlZm9yZUVsZW1lbnQucXVlcnlTZWxlY3RvcignaW1nJyk7XG4gIH1cblxuICBbYWRkRXZlbnRMaXN0ZW5lcnNdKCkge1xuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMub25UYXAuYmluZCh0aGlzKSk7XG4gICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHRoaXMub25EcmFnLmJpbmQodGhpcykpO1xuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCB0aGlzLm9uRHJhZy5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLmRyYWdFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMub25EcmFnU3RhcnQuYmluZCh0aGlzKSk7XG4gICAgdGhpcy5kcmFnRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgdGhpcy5vbkRyYWdTdGFydC5iaW5kKHRoaXMpKTtcblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgdGhpcy5vbkRyYWdFbmQuYmluZCh0aGlzKSk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHRoaXMuZGltZW5zaW9ucy5iaW5kKHRoaXMpKTtcbiAgfVxuXG4gIG9uVGFwKGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICB0aGlzLmxlZnRQb3MgPSAoZS5wYWdlWCkgPyBlLnBhZ2VYIDogZS5vcmlnaW5hbEV2ZW50LnRvdWNoZXNbMF0ucGFnZVg7XG4gICAgdGhpcy5yZXF1ZXN0RHJhZygpO1xuICB9XG5cbiAgb25EcmFnU3RhcnQoZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgIGNvbnN0IHN0YXJ0WCA9IChlLnBhZ2VYKSA/IGUucGFnZVggOiBlLm9yaWdpbmFsRXZlbnQudG91Y2hlc1swXS5wYWdlWDtcbiAgICBjb25zdCBvZmZzZXRMZWZ0ID0gdGhpcy5kcmFnRWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0ICsgZG9jdW1lbnQuYm9keS5zY3JvbGxMZWZ0O1xuICAgIHRoaXMucG9zWCA9IChvZmZzZXRMZWZ0ICsgdGhpcy5kcmFnRWxlbWVudFdpZHRoKSAtIHN0YXJ0WDtcbiAgICB0aGlzLmlzRHJhZ2dpbmcgPSB0cnVlO1xuICB9XG5cbiAgb25EcmFnRW5kKGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgdGhpcy5pc0RyYWdnaW5nID0gZmFsc2U7XG4gIH1cblxuICBvbkRyYWcoZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgIGlmICghdGhpcy5pc0RyYWdnaW5nKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5tb3ZlWCA9IChlLnBhZ2VYKSA/IGUucGFnZVggOiBlLm9yaWdpbmFsRXZlbnQudG91Y2hlc1swXS5wYWdlWDtcbiAgICB0aGlzLmxlZnRQb3MgPSAodGhpcy5tb3ZlWCArIHRoaXMucG9zWCkgLSB0aGlzLmRyYWdFbGVtZW50V2lkdGg7XG5cbiAgICB0aGlzLnJlcXVlc3REcmFnKCk7XG4gIH1cblxuICBkaW1lbnNpb25zKCkge1xuICAgIHRoaXMuZWxlbWVudFdpZHRoID0gcGFyc2VJbnQod2luZG93LmdldENvbXB1dGVkU3R5bGUodGhpcy5lbGVtZW50KS53aWR0aCwgMTApO1xuICAgIHRoaXMuZWxlbWVudE9mZnNldExlZnQgPSB0aGlzLmVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdCArIGRvY3VtZW50LmJvZHkuc2Nyb2xsTGVmdDtcbiAgICB0aGlzLmJlZm9yZUltYWdlLnN0eWxlLndpZHRoID0gYCR7dGhpcy5lbGVtZW50V2lkdGh9cHhgO1xuICAgIHRoaXMuZHJhZ0VsZW1lbnRXaWR0aCA9IHBhcnNlSW50KHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHRoaXMuZHJhZ0VsZW1lbnQpLndpZHRoLCAxMCk7XG4gICAgdGhpcy5taW5MZWZ0UG9zID0gdGhpcy5lbGVtZW50T2Zmc2V0TGVmdCArIDEwO1xuICAgIHRoaXMubWF4TGVmdFBvcyA9ICh0aGlzLmVsZW1lbnRPZmZzZXRMZWZ0ICsgdGhpcy5lbGVtZW50V2lkdGgpIC0gdGhpcy5kcmFnRWxlbWVudFdpZHRoIC0gMTA7XG4gIH1cblxuICBkcmFnKCkge1xuICAgIGlmICh0aGlzLmxlZnRQb3MgPCB0aGlzLm1pbkxlZnRQb3MpIHtcbiAgICAgIHRoaXMubGVmdFBvcyA9IHRoaXMubWluTGVmdFBvcztcbiAgICB9IGVsc2UgaWYgKHRoaXMubGVmdFBvcyA+IHRoaXMubWF4TGVmdFBvcykge1xuICAgICAgdGhpcy5sZWZ0UG9zID0gdGhpcy5tYXhMZWZ0UG9zO1xuICAgIH1cblxuICAgIGxldCBvcGVuUmF0aW8gPSAodGhpcy5sZWZ0UG9zICsgKHRoaXMuZHJhZ0VsZW1lbnRXaWR0aCAvIDIpKSAtIHRoaXMuZWxlbWVudE9mZnNldExlZnQ7XG4gICAgb3BlblJhdGlvIC89IHRoaXMuZWxlbWVudFdpZHRoO1xuICAgIGNvbnN0IHdpZHRoID0gYCR7b3BlblJhdGlvICogMTAwfSVgO1xuXG4gICAgdGhpcy5kcmFnRWxlbWVudC5zdHlsZS5sZWZ0ID0gd2lkdGg7XG4gICAgdGhpcy5iZWZvcmVFbGVtZW50LnN0eWxlLndpZHRoID0gd2lkdGg7XG5cbiAgICBpZiAodGhpcy5vcHRpb25zLmRyYWdDYWxsYmFjaykge1xuICAgICAgdGhpcy5vcHRpb25zLmRyYWdDYWxsYmFjayhvcGVuUmF0aW8pO1xuICAgIH1cbiAgfVxuXG4gIHJlcXVlc3REcmFnKCkge1xuICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5kcmFnLmJpbmQodGhpcykpO1xuICB9XG59XG5cbkNvY29lbi5kZWZhdWx0cyA9IHtcbiAgZHJhZ0VsZW1lbnRTZWxlY3RvcjogJy5jb2NvZW4tZHJhZycsXG4gIGRyYWdDYWxsYmFjazogbnVsbCxcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gQ29jb2VuO1xuIl19"}